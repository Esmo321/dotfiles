# Variables
set $mod 			Mod4
set $wallpaper 		$HOME/.screen/wallpaper/set.sh
set $lockscreen		$HOME/.screen/lockscreen/set.sh
set $screenoff		xset dpms force off

# Modifier key
set $mod Mod4

#Visual tweaks
font pango:                         	Noto 9
focus_follows_mouse                 	no

# Window colors
client.focused                      	#3b3b3b   #444444   #FFFFFF   #212121
client.focused_inactive             	#444444   #111111   #DDDDDD   #101010
client.unfocused                    	#111111   #000000   #FFFFFF   #000000

# Firefox hijack Ctrl+Q
bindsym Ctrl+Q 							exec "exit"

# Startup
exec 	--no-startup-id 				$HOME/.i3/polybar.sh

exec	--no-startup-id                	"redshift-gtk"
exec 	--no-startup-id                	"numlockx on"
exec 	--no-startup-id                	"syncthing"
exec 	--no-startup-id                	"$wallpaper"
exec 	--no-startup-id               	"unclutter -idle 1"

exec 	--no-startup-id 				"sudo su -c \"echo -n 120 > /sys/devices/platform/i8042/serio1/sensitivity\""
exec 	--no-startup-id 				"sudo su -c \"echo -n 0 > /sys/devices/platform/i8042/serio1/press_to_select\""

#exec 	--no-startup-id 				"autossh -M 10000 serveo.net -R $hostname.filiparag.com:80:localhost:80 -C -f"
#exec 	--no-startup-id 				"autossh -M 20000 serveo.net -R $hostname:22:localhost:22 -C -f"

exec 	--no-startup-id                	"echo 2 > $HOME/.screen/layout/.mode; $HOME/.screen/portable.sh"

#exec 	--no-startup-id 				i3-msg 'exec /usr/bin/keepassxc'
exec 	--no-startup-id 				i3-msg 'exec /usr/bin/signal-desktop --start-in-tray'

#exec 	--no-startup-id                	"sshfs $USER@172.16.186.162:/data/archive/$USER /data/"

# Programs
bindsym $mod+Return                 	exec "urxvt"
bindsym $mod+Shift+Return           	exec "urxvt -name scratchpad -hold -e tmux new-session -A -s background"
bindsym $mod+B                      	exec "firefox"
bindsym $mod+Shift+B                	exec "firefox -private-window"
bindsym $mod+N                      	exec "pcmanfm"
bindsym $mod+Shift+N               	 	exec "sudo pcmanfm"
bindsym $mod+V                      	exec "code"
bindsym $mod+K                      	exec "keepassxc"

# Appearance tweaks
new_window pixel 0
for_window [instance="scratchpad"] 		move window to scratchpad, move position center, scratchpad show 
for_window [instance="floating"] 		floating enable, border none
for_window [class="Signal"] 			move container to workspace Signal
for_window [class="keepassxc"] 			move container to workspace KeePassXC
for_window [class="Spotify"] 			move container to workspace Spotify

# Rofi menu
bindsym $mod+D                      	exec "rofi -modi drun,run,combi -combi-modi drun,run -show combi -theme Arc-Dark -width 25 -lines 8 -show-icons -icon-theme -font Source\ Code\ Pro\ 12"
bindsym $mod+Tab                    	exec "rofi -show window -theme Arc-Dark -width 40 -lines 8 -show-icons -icon-theme -font Source\ Code\ Pro\ 12"
bindsym $mod+Z                    		exec "$HOME/.i3/emoji.sh"
bindsym $mod+S							exec "$HOME/.i3/search.sh"
bindsym $mod+Shift+S 					exec "rofi -show calc -modi calc -width 25 -lines 5 -theme Arc-Dark -font Source\ Code\ Pro\ 12"

# Window controls
bindsym $mod+Shift+Q                	kill
bindsym $mod+F                      	fullscreen

# Focus controls
bindsym $mod+Left                   	focus left
bindsym $mod+Down                   	focus down
bindsym $mod+Up                     	focus up
bindsym $mod+Right                  	focus right

bindsym $mod+Control+Left           	workspace prev
bindsym $mod+Control+Right          	workspace next

# Moving controls
bindsym $mod+Shift+Left             	move left
bindsym $mod+Shift+Down             	move down
bindsym $mod+Shift+Up               	move up
bindsym $mod+Shift+Right            	move right

# Layout tiling
bindsym $mod+W                      	layout tabbed
bindsym $mod+E                      	layout toggle split
bindsym $mod+Shift+space            	floating toggle; border normal 1
workspace_layout                    	tabbed

# Key remapping
exec 	--no-startup-id                	"setxkbmap -layout \"us,rs,rs\" -variant \",latinunicode,\" -option grp:alt_shift_toggle"
exec	--no-startup-id                	"sleep 2; $HOME/.i3/keymap.sh"

# Switch workspaces
bindsym $mod+grave                  	workspace 0
bindsym $mod+1                      	workspace 1
bindsym $mod+2                      	workspace 2
bindsym $mod+3                      	workspace 3
bindsym $mod+4                      	workspace 4
bindsym $mod+5                      	workspace 5
bindsym $mod+6                      	workspace 6
bindsym $mod+7                      	workspace 7
bindsym $mod+8                      	workspace 8
bindsym $mod+9                      	workspace 9
bindsym $mod+0                      	workspace 10

bindsym $mod+F1                      	workspace Signal
bindsym $mod+F2                      	workspace KeePassXC
bindsym $mod+F3                      	workspace Spotify

# Move windows to workspace
bindsym $mod+Shift+grave            	move container to workspace 0
bindsym $mod+Shift+1                	move container to workspace 1
bindsym $mod+Shift+2                	move container to workspace 2
bindsym $mod+Shift+3                	move container to workspace 3
bindsym $mod+Shift+4                	move container to workspace 4
bindsym $mod+Shift+5                	move container to workspace 5
bindsym $mod+Shift+6                	move container to workspace 6
bindsym $mod+Shift+7                	move container to workspace 7
bindsym $mod+Shift+8                	move container to workspace 8
bindsym $mod+Shift+9                	move container to workspace 9
bindsym $mod+Shift+0                	move container to workspace 10

# VPN control
bindsym $mod+Shift+V       				exec "urxvt -hold -e windscribe connect"
bindsym $mod+Control+Shift+V    		exec "urxvt -hold -e windscribe disconnect"

# Screenshot
bindsym --release $mod+P   				exec "$HOME/.i3/screenshot.sh"
bindsym --release $mod+Shift+P			exec "flameshot gui -p $HOME/Pictures/Screenshots/"

# Audio
bindsym XF86AudioRaiseVolume        	exec "pactl set-sink-volume 0 +2%"
bindsym XF86AudioLowerVolume        	exec "pactl set-sink-volume 0 -2%"
bindsym $mod+Prior			        	exec "pactl set-sink-volume 0 +2%"
bindsym $mod+Next			        	exec "pactl set-sink-volume 0 -2%"

bindsym XF86AudioMute               	exec "amixer -D pulse set Master toggle"

bindsym $mod+XF86AudioLowerVolume  		exec "$HOME/.i3/backlight.sh - 2"
bindsym $mod+XF86AudioRaiseVolume  		exec "$HOME/.i3/backlight.sh + 2"
#bindsym Control+XF86AudioLowerVolume  	exec "$HOME/.config/i3/backlight.sh = 3"
#bindsym Control+XF86AudioRaiseVolume  	exec "$HOME/.config/i3/backlight.sh = 100"

# Lockscreen
bindsym XF86Launch1                 	exec "i3lock;"
bindsym $mod+L                 			exec "$lockscreen; sleep 0.5; $screenoff;"

# X230 specific
bindsym $mod+XF86Launch1            	exec "sleep 0.5; $screenoff;" 
bindsym XF86AudioMicMute            	exec "$HOME/.screen/toggle.sh"
bindsym $mod+XF86AudioMute          	exec "pavucontrol"
bindsym $mod+Shift+XF86AudioMute    	exec "qpaeq"
bindsym $mod+XF86AudioMicMute       	exec "arandr"
exec 	--no-startup-id					"sudo bash -c \"echo '0 off' > /proc/acpi/ibm/led\""

# Power control
bindsym $mod+Shift+R                	exec "i3-msg restart; $HOME/.i3/polybar.sh; $wallpaper; "
bindsym $mod+Shift+E                	exec "i3-nagbar -t warning -m 'End i3 session?' -b 'Yes' 'i3-msg exit'"
bindsym $mod+Shift+Delete           	exec "systemctl poweroff"
bindsym $mod+Shift+Ctrl+Delete      	exec "systemctl reboot"
bindsym $mod+Delete                 	exec "echo 2 > $HOME/.screen/layout/.mode; $HOME/.screen/layout/portable.sh; $lockscreen; systemctl suspend; $wallpaper;"

# Resizing
bindsym $mod+R                      	mode "resize"
mode "resize" {

		bindsym Left                	resize shrink 	width 	5 px 	or 5 ppt
		bindsym Down                	resize grow 	height 	5 px 	or 5 ppt
		bindsym Up                  	resize shrink 	height 	5 px 	or 5 ppt
		bindsym Right               	resize grow 	width 	5 px 	or 5 ppt

		bindsym Shift+Left          	resize shrink 	width 	75 px 	or 75 ppt
		bindsym Shift+Down          	resize grow 	height 	75 px 	or 75 ppt
		bindsym Shift+Up            	resize shrink 	height 	75 px 	or 75 ppt
		bindsym Shift+Right         	resize grow 	width 	75 px 	or 75 ppt

		bindsym Return mode         	"default"
		bindsym Escape mode         	"default"
}
